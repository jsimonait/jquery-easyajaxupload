/**
 * jQuery Easy Ajax File Uploader
 * @author: jsimonait <jsimonait@gmail.com>
 */(function(a){a.fn.easyajaxupload=function(b){if(0==this.length||void 0==arguments[0])return this;if("string"==typeof arguments[0]){if(1<this.length){var c=arguments;return this.each(function(){a.fn.easyajaxupload.apply(a(this),c)})}a.fn.easyajaxupload[arguments[0]].apply(this,a.makeArray(arguments).slice(1)||[]);return this}b=a.extend({},a.fn.easyajaxupload.options,b||{});a(this).data("easyajaxupload",a.extend({},b));return this};a.extend(a.fn.easyajaxupload,{upload:function(){var b=a(this),c=this.data("easyajaxupload"); if(!c)return this;if(""==b.val())return c.onCancel.apply(b);var e="easyAjaxUploader-iframe-"+Math.round((new Date).getTime()/1E3);a("body").after('<iframe width="0" height="0" style="display:none;" name="'+e+'" id="'+e+'" />');a("#"+e).load(function(){var f,g=this.contentWindow.document.body.innerHTML;if(g){try{f=JSON.parse(g)}catch(d){f=g}b.siblings().remove();b.unwrap();a(this).remove();c.onComplete.apply(b,[f,c.params])}});b.wrap(function(){return'<form action="'+c.action+'" method="POST" enctype="multipart/form-data" target="'+ e+'" />'}).before(function(){var a,b="";for(a in c.params){var d=c.params[a];"function"===typeof d&&(d=d());b+='<input type="hidden" name="'+a+'" value="'+d+'" />'}return b});!1!==c.onStart.apply(b,[c.params])&&b.parent("form").submit(function(a){a.stopPropagation()}).submit()}});a.fn.easyajaxupload.options={action:"",params:{},onStart:function(){console.log("starting upload");console.log(this)},onComplete:function(a){console.log("got response: ");console.log(a);console.log(this)},onCancel:function(){console.log("cancelling: "); console.log(this)}}})(jQuery);